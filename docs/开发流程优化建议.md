# DeepReader é¡¹ç›®å¼€å‘æµç¨‹ä¼˜åŒ–å»ºè®®

## ğŸ“Š å½“å‰é¡¹ç›®çŠ¶æ€

- **ä»£ç æ–‡ä»¶**: 54 ä¸ª (Rust + TypeScript/TSX)
- **æ–‡æ¡£æ–‡ä»¶**: 13 ä¸ª Markdown æ–‡æ¡£
- **æµ‹è¯•è¦†ç›–**: âš ï¸ åç«¯éƒ¨åˆ†å•å…ƒæµ‹è¯•ï¼Œå‰ç«¯æ— æµ‹è¯•
- **CI/CD**: âŒ æœªé…ç½®
- **ä»£ç è§„èŒƒ**: âš ï¸ éƒ¨åˆ†é…ç½®

---

## ğŸ¯ ä¼˜åŒ–å»ºè®®ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰

### 1. ğŸ“‹ æµ‹è¯•ä½“ç³»å»ºè®¾ â­â­â­â­â­

#### å½“å‰é—®é¢˜
- âŒ å‰ç«¯å®Œå…¨æ²¡æœ‰æµ‹è¯•
- âš ï¸ åç«¯åªæœ‰éƒ¨åˆ†å•å…ƒæµ‹è¯•ï¼ˆåœ¨ `integration_tests.rs` ä¸­ï¼‰
- âŒ æ²¡æœ‰ç«¯åˆ°ç«¯æµ‹è¯•
- âŒ Debug é¢æ¿ç­‰æ–°åŠŸèƒ½æœªæµ‹è¯•

#### å»ºè®®æ–¹æ¡ˆ

**A. å‰ç«¯æµ‹è¯•æ¡†æ¶**

```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
pnpm add -D vitest @testing-library/react @testing-library/jest-dom @testing-library/user-event jsdom
```

**package.json æ·»åŠ è„šæœ¬**:
```json
{
  "scripts": {
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest --coverage"
  }
}
```

**åˆ›å»ºæµ‹è¯•é…ç½®** (`vitest.config.ts`):
```typescript
import { defineConfig } from 'vitest/config'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: './src/test/setup.ts',
  },
})
```

**ä¼˜å…ˆæµ‹è¯•çš„ç»„ä»¶**:
1. `ReadingUnitDebugger` - æ–°å®ç°çš„ Debug é¢æ¿
2. `SegmentDetailPanel` - æ ¸å¿ƒè¯„åˆ†å±•ç¤ºé€»è¾‘
3. `ImmersiveReader` - ä¸»é˜…è¯»å™¨ç»„ä»¶

**B. åç«¯æµ‹è¯•å¢å¼º**

```rust
// åœ¨ src-tauri/src/lib.rs ä¸­æ·»åŠ æµ‹è¯•æ¨¡å—
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_get_debug_data() {
        // æµ‹è¯• debug API
    }

    #[test]
    fn test_get_reading_units() {
        // æµ‹è¯• reading units API
    }
}
```

**C. é›†æˆæµ‹è¯•**

ä½¿ç”¨ Tauri çš„ WebDriver æµ‹è¯•:
```bash
pnpm add -D @tauri-apps/cli webdriverio
```

---

### 2. ğŸ”„ CI/CD æµæ°´çº¿ â­â­â­â­â­

#### å»ºè®®é…ç½®

**åˆ›å»º `.github/workflows/ci.yml`**:

```yaml
name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  test-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'pnpm'
      - run: pnpm install
      - run: pnpm test
      - run: pnpm build

  test-backend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
      - run: cd src-tauri && cargo test
      - run: cd src-tauri && cargo clippy -- -D warnings

  build:
    needs: [test-frontend, test-backend]
    strategy:
      matrix:
        platform: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.platform }}
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
      - uses: actions-rs/toolchain@v1
      - run: pnpm install
      - run: pnpm tauri build
```

**åˆ›å»º `.github/workflows/release.yml`**:

```yaml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    strategy:
      matrix:
        platform: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.platform }}
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
      - uses: actions-rs/toolchain@v1
      - run: pnpm install
      - run: pnpm tauri build
      - uses: softprops/action-gh-release@v1
        with:
          files: src-tauri/target/release/bundle/**/*
```

---

### 3. ğŸ“ ä»£ç è§„èŒƒä¸è´¨é‡ â­â­â­â­

#### A. ESLint + Prettier é…ç½®

**å®‰è£…ä¾èµ–**:
```bash
pnpm add -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-react eslint-plugin-react-hooks prettier eslint-config-prettier
```

**åˆ›å»º `.eslintrc.json`**:
```json
{
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:react/recommended",
    "plugin:react-hooks/recommended",
    "prettier"
  ],
  "parser": "@typescript-eslint/parser",
  "plugins": ["@typescript-eslint", "react", "react-hooks"],
  "rules": {
    "react/react-in-jsx-scope": "off",
    "@typescript-eslint/no-explicit-any": "warn"
  }
}
```

**åˆ›å»º `.prettierrc`**:
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2
}
```

**package.json æ·»åŠ è„šæœ¬**:
```json
{
  "scripts": {
    "lint": "eslint src --ext .ts,.tsx",
    "lint:fix": "eslint src --ext .ts,.tsx --fix",
    "format": "prettier --write \"src/**/*.{ts,tsx,css}\""
  }
}
```

#### B. Rust ä»£ç è§„èŒƒ

**åˆ›å»º `src-tauri/.rustfmt.toml`**:
```toml
edition = "2021"
max_width = 100
hard_tabs = false
tab_spaces = 4
```

**æ·»åŠ  Clippy é…ç½®** (`src-tauri/Cargo.toml`):
```toml
[lints.clippy]
all = "warn"
pedantic = "warn"
```

---

### 4. ğŸ” ä»£ç å®¡æŸ¥æµç¨‹ â­â­â­â­

#### å»ºè®®

**åˆ›å»º `.github/PULL_REQUEST_TEMPLATE.md`**:

```markdown
## ğŸ“ å˜æ›´è¯´æ˜

<!-- æè¿°è¿™ä¸ª PR åšäº†ä»€ä¹ˆ -->

## ğŸ¯ ç›¸å…³ Issue

<!-- å…³è”çš„ Issue ç¼–å·ï¼Œå¦‚ #123 -->

## âœ… æ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²é€šè¿‡ `pnpm lint` æ£€æŸ¥
- [ ] å·²æ·»åŠ /æ›´æ–°ç›¸å…³æµ‹è¯•
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡ (`pnpm test`)
- [ ] å·²æ›´æ–°ç›¸å…³æ–‡æ¡£
- [ ] Rust ä»£ç é€šè¿‡ `cargo clippy` æ£€æŸ¥
- [ ] å·²åœ¨æœ¬åœ°æµ‹è¯•åŠŸèƒ½æ­£å¸¸

## ğŸ“¸ æˆªå›¾ï¼ˆå¦‚é€‚ç”¨ï¼‰

<!-- æ·»åŠ æˆªå›¾å±•ç¤ºå˜æ›´ -->

## ğŸ”— ç›¸å…³é“¾æ¥

<!-- ç›¸å…³çš„è®¾è®¡æ–‡æ¡£ã€PRD ç­‰ -->
```

**åˆ›å»º `.github/CODEOWNERS`**:
```
# ä»£ç æ‰€æœ‰è€…
* @your-username

# ç‰¹å®šæ¨¡å—
/src/components/debug/ @debug-team
/src-tauri/src/reading_unit/ @backend-team
```

---

### 5. ğŸ“š æ–‡æ¡£ä½“ç³»å®Œå–„ â­â­â­â­

#### å½“å‰æ–‡æ¡£ç»“æ„
```
docs/
â”œâ”€â”€ ç« èŠ‚åˆ‡åˆ†_debug_é¢æ¿_prd.md
â”œâ”€â”€ ç« èŠ‚åˆ‡åˆ†_debug_é¢æ¿_å®ç°æ€»ç»“.md
â””â”€â”€ ... (å…¶ä»– 11 ä¸ªæ–‡æ¡£)
```

#### å»ºè®®è¡¥å……

**A. å¼€å‘æ–‡æ¡£**

åˆ›å»º `docs/development/`:
```
docs/development/
â”œâ”€â”€ SETUP.md              # å¼€å‘ç¯å¢ƒæ­å»º
â”œâ”€â”€ ARCHITECTURE.md       # æ¶æ„è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ API.md                # API æ–‡æ¡£
â”œâ”€â”€ TESTING.md            # æµ‹è¯•æŒ‡å—
â””â”€â”€ CONTRIBUTING.md       # è´¡çŒ®æŒ‡å—
```

**B. API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ**

å¯¹äº Rust ä»£ç :
```bash
cd src-tauri
cargo doc --open
```

å¯¹äº TypeScript:
```bash
pnpm add -D typedoc
pnpm typedoc --out docs/api src
```

**C. ç”¨æˆ·æ–‡æ¡£**

åˆ›å»º `docs/user-guide/`:
```
docs/user-guide/
â”œâ”€â”€ getting-started.md    # å¿«é€Ÿå¼€å§‹
â”œâ”€â”€ features.md           # åŠŸèƒ½ä»‹ç»
â”œâ”€â”€ faq.md                # å¸¸è§é—®é¢˜
â””â”€â”€ troubleshooting.md    # æ•…éšœæ’é™¤
```

---

### 6. ğŸ› é”™è¯¯è¿½è¸ªä¸æ—¥å¿— â­â­â­

#### A. å‰ç«¯é”™è¯¯è¿½è¸ª

**å®‰è£… Sentry (å¯é€‰)**:
```bash
pnpm add @sentry/react @sentry/tauri
```

**æˆ–ä½¿ç”¨ç®€å•çš„æ—¥å¿—ç³»ç»Ÿ**:

åˆ›å»º `src/utils/logger.ts`:
```typescript
export const logger = {
  info: (message: string, data?: any) => {
    console.log(`[INFO] ${message}`, data);
  },
  error: (message: string, error?: any) => {
    console.error(`[ERROR] ${message}`, error);
    // å¯ä»¥å‘é€åˆ°æ—¥å¿—æœåŠ¡
  },
  debug: (message: string, data?: any) => {
    if (import.meta.env.DEV) {
      console.debug(`[DEBUG] ${message}`, data);
    }
  },
};
```

#### B. åç«¯æ—¥å¿—

**ä½¿ç”¨ `tracing` åº“**:

```toml
# Cargo.toml
[dependencies]
tracing = "0.1"
tracing-subscriber = "0.3"
```

```rust
// main.rs
use tracing_subscriber;

fn main() {
    tracing_subscriber::fmt::init();

    // ... åº”ç”¨ä»£ç 
}
```

---

### 7. ğŸ” å®‰å…¨å®¡è®¡ â­â­â­

#### å»ºè®®

**A. ä¾èµ–å®‰å…¨æ£€æŸ¥**

```bash
# Rust
cargo install cargo-audit
cargo audit

# Node.js
pnpm audit
```

**B. æ·»åŠ åˆ° CI**:

```yaml
- name: Security Audit
  run: |
    cargo install cargo-audit
    cd src-tauri && cargo audit
    pnpm audit --audit-level=moderate
```

**C. å®šæœŸæ›´æ–°ä¾èµ–**

åˆ›å»º `.github/dependabot.yml`:
```yaml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"

  - package-ecosystem: "cargo"
    directory: "/src-tauri"
    schedule:
      interval: "weekly"
```

---

### 8. ğŸ“Š æ€§èƒ½ç›‘æ§ â­â­â­

#### å»ºè®®

**A. å‰ç«¯æ€§èƒ½ç›‘æ§**

```typescript
// src/utils/performance.ts
export const measurePerformance = (name: string, fn: () => void) => {
  const start = performance.now();
  fn();
  const end = performance.now();
  console.log(`[Performance] ${name}: ${end - start}ms`);
};
```

**B. åç«¯æ€§èƒ½åˆ†æ**

```rust
use std::time::Instant;

fn measure_time<F: FnOnce() -> R, R>(name: &str, f: F) -> R {
    let start = Instant::now();
    let result = f();
    let duration = start.elapsed();
    println!("[Performance] {}: {:?}", name, duration);
    result
}
```

---

### 9. ğŸ”„ ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ â­â­â­

#### å»ºè®®é‡‡ç”¨ Git Flow

```
main (ç”Ÿäº§)
  â†‘
develop (å¼€å‘)
  â†‘
feature/* (åŠŸèƒ½åˆ†æ”¯)
hotfix/* (ç´§æ€¥ä¿®å¤)
release/* (å‘å¸ƒåˆ†æ”¯)
```

**ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬**:
- `v1.0.0` - ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·
- ä¸»ç‰ˆæœ¬: ä¸å…¼å®¹çš„ API ä¿®æ”¹
- æ¬¡ç‰ˆæœ¬: å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- ä¿®è®¢å·: å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

---

### 10. ğŸš€ å‘å¸ƒæµç¨‹è‡ªåŠ¨åŒ– â­â­â­

#### å»ºè®®

**ä½¿ç”¨ `release-it` æˆ– `semantic-release`**:

```bash
pnpm add -D release-it
```

**åˆ›å»º `.release-it.json`**:
```json
{
  "git": {
    "commitMessage": "chore: release v${version}",
    "tagName": "v${version}"
  },
  "github": {
    "release": true
  },
  "npm": {
    "publish": false
  }
}
```

**package.json æ·»åŠ è„šæœ¬**:
```json
{
  "scripts": {
    "release": "release-it"
  }
}
```

---

## ğŸ“‹ å®æ–½ä¼˜å…ˆçº§

### ğŸ”¥ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰
1. âœ… **æµ‹è¯•ä½“ç³»å»ºè®¾** - ä¿è¯ä»£ç è´¨é‡
2. âœ… **CI/CD æµæ°´çº¿** - è‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•
3. âœ… **ä»£ç è§„èŒƒ** - ç»Ÿä¸€ä»£ç é£æ ¼

### ğŸŒŸ ä¸­ä¼˜å…ˆçº§ï¼ˆè¿‘æœŸå®æ–½ï¼‰
4. âœ… **ä»£ç å®¡æŸ¥æµç¨‹** - æé«˜ä»£ç è´¨é‡
5. âœ… **æ–‡æ¡£å®Œå–„** - é™ä½ç»´æŠ¤æˆæœ¬
6. âœ… **é”™è¯¯è¿½è¸ª** - å¿«é€Ÿå®šä½é—®é¢˜

### ğŸ’¡ ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰
7. âœ… **å®‰å…¨å®¡è®¡** - å®šæœŸæ£€æŸ¥
8. âœ… **æ€§èƒ½ç›‘æ§** - æŒç»­ä¼˜åŒ–
9. âœ… **ç‰ˆæœ¬ç®¡ç†** - è§„èŒƒå‘å¸ƒ
10. âœ… **å‘å¸ƒè‡ªåŠ¨åŒ–** - æé«˜æ•ˆç‡

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€å‘¨
- [ ] é…ç½® ESLint + Prettier
- [ ] æ·»åŠ å‰ç«¯æµ‹è¯•æ¡†æ¶
- [ ] ä¸º Debug é¢æ¿ç¼–å†™æµ‹è¯•

### ç¬¬äºŒå‘¨
- [ ] é…ç½® GitHub Actions CI
- [ ] æ·»åŠ  PR æ¨¡æ¿
- [ ] å®Œå–„ README å’Œå¼€å‘æ–‡æ¡£

### ç¬¬ä¸‰å‘¨
- [ ] å¢åŠ åç«¯æµ‹è¯•è¦†ç›–ç‡
- [ ] é…ç½®è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹
- [ ] æ·»åŠ æ€§èƒ½ç›‘æ§

### ç¬¬å››å‘¨
- [ ] å®‰å…¨å®¡è®¡
- [ ] æ–‡æ¡£å®Œå–„
- [ ] ä»£ç é‡æ„å’Œä¼˜åŒ–

---

## ğŸ“š å‚è€ƒèµ„æº

- [Tauri æœ€ä½³å®è·µ](https://tauri.app/v1/guides/testing/)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [Vitest æ–‡æ¡£](https://vitest.dev/)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)

---

## ğŸ’¬ æ€»ç»“

é€šè¿‡å®æ–½è¿™äº›ä¼˜åŒ–å»ºè®®ï¼ŒDeepReader é¡¹ç›®å°†è·å¾—ï¼š

âœ… **æ›´é«˜çš„ä»£ç è´¨é‡** - é€šè¿‡æµ‹è¯•å’Œä»£ç è§„èŒƒ
âœ… **æ›´å¿«çš„å¼€å‘é€Ÿåº¦** - é€šè¿‡è‡ªåŠ¨åŒ–æµç¨‹
âœ… **æ›´å¥½çš„åä½œä½“éªŒ** - é€šè¿‡è§„èŒƒçš„æµç¨‹å’Œæ–‡æ¡£
âœ… **æ›´ç¨³å®šçš„äº§å“** - é€šè¿‡æŒç»­é›†æˆå’Œæµ‹è¯•
âœ… **æ›´å®¹æ˜“ç»´æŠ¤** - é€šè¿‡æ¸…æ™°çš„æ–‡æ¡£å’Œæ¶æ„

å»ºè®®ä»é«˜ä¼˜å…ˆçº§é¡¹ç›®å¼€å§‹ï¼Œé€æ­¥å®æ–½è¿™äº›ä¼˜åŒ–æªæ–½ã€‚æ¯ä¸ªä¼˜åŒ–éƒ½ä¼šä¸ºé¡¹ç›®å¸¦æ¥å®å®åœ¨åœ¨çš„ä»·å€¼ï¼

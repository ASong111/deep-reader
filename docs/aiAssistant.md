📚 沉浸式阅读器 AI 助手模块 PRD 规划（基础功能 MVP 版）
🎯 一、项目概览 (Project Overview)
1.1 项目名称沉浸式阅读器 AI 助手模块（Immersive Reader AI Assistant Module）
1.2 目标用户学者、研究人员、学生、律师、重度知识工作者、对隐私敏感的数字原住民。
1.3 总体目标将沉浸式阅读器从内容消费工具升级为高效知识生产力工具。通过提供隐形、克制、专业的 AI 辅助，增强用户对专业文本的深度理解、分析和知识提取能力，同时严格维护阅读沉浸感。
1.4 核心痛点与价值痛点AI 助手提供的价值阅读中断一键释义和翻译，无需跳出应用，保持思维流畅性。知识浅薄深度探索功能，提供可验证的结构化背景知识。研究孤立互动讨论模式，提供一个基于文本的专业“研讨伙伴”。效率低下智能摘要和笔记整理，加速知识内化与回顾。
✅ 二、核心需求 (Core Requirements)
2.1 聚焦效率与低干扰
仅实现消除阅读障碍的核心功能，严格保持极简、克制的交互设计。

2.2 上下文限制
所有 AI 查询和讨论仅基于当前正在阅读的章节内容。不进行全文分析 (F4.0)，以最小化启动成本和 LLM 资源消耗。

2.3 技术栈约束
所有功能实现必须兼容 Rust/Tauri + React 技术栈，优先使用 Rust 处理文本和与外部 API 的通信。

💻 三、核心功能 (Core Features) - 基础版 MVP
ID,功能名称,触发机制,核心规格 (Specs) - MVP
F1.0,即时理解（简洁释义/翻译）,选中文字 -> 工具栏“一键释义”按钮,简洁为王：纯文本释义，2-3 行以内。结果展示在右下侧边栏，持续显示直到用户关闭。作为引流和免费核心功能。
F2.0,深度探索（受限）,F1.0 结果中的“了解更多”链接,侧边栏动态扩展，展示更详细的纯文本释义（不带结构化标题和引用来源）。仅作为 F1.0 的延伸，不涉及复杂的知识整合。
F3.0,互动讨论（本章上下文）,右下侧边栏常驻“对话模式”按钮,上下文限制： Agent 仅读取当前章节内容进行问答。无对话历史持久化。回复中不强制附加锚点链接（简化实现难度）。
F7.0 (New),基础数据传输,用户打开章节时自动触发,Rust 后端使用 Epub-rs 解析并提取当前章节纯文本，通过 Tauri Command 传输给 Agent Core 作为即时上下文。

🧩 四、核心组件 (Core Components) - MVP 调整
组件,Rust/Tauri 实现方式 (New),MVP 调整与限制
Agent Core,Rust (Reqwest + tokio),仅处理即时释义和本章问答的 API 请求。
Context Handler,Rust (Epub-rs + Tauri 侧载),仅加载当前章节内容。 不涉及全文分块或高级索引。
Knowledge Vault,移除或占位： 该组件在 MVP 中不需要实际实现，因为我们不进行知识持久化。可以预留结构，但不投入开发资源。,成本控制。
Anchor Link Resolver,移除或占位： 由于 F3.0 不强制提供锚点，该组件的复杂解析逻辑暂不实现。,简化实现难度。
Sidebar UI Controller,React 19 + TailwindCSS,实现 F1.0 和 F3.0 的两种模式切换和基础的动态扩展。

🌊 五、应用/用户流程 (App/User Flow) - MVP 流程
5.1 即时理解（F1.0）流程
用户在阅读主视图选中文字。

浮动工具栏出现“一键释义”按钮。

用户点击，Context Handler 提取选中词汇。

Agent Core 调用 LLM，基于词汇本身或当前章节上下文返回简洁释义 (F1.0)。

释义结果以纯文本显示在右下侧边栏，无“了解更多”链接。

5.2 互动讨论（F3.0 - 本章）流程
用户在右下侧边栏点击“互动讨论”图标，进入对话模式 (F3.0)。

F7.0 确保当前章节文本已作为上下文传入 Agent Core。

用户提问（例如：“本章主要观点是什么？”）。

Agent Core 基于当前章节上下文回答。

无锚点链接，回复以纯文本气泡形式展示。

🗓️ 六、实施计划 (Implementation Plan) - 基础版加速
聚焦于 Rust 后端和 React 前端的最小化功能实现。

第一阶段：MVP 与基础架构
核心焦点： 搭建 Tauri + React 通信，实现即时理解的端到端（End-to-End）流程。

后端 (Rust)：

集成 Epub-rs，实现基础章节内容提取 (F7.0)。

实现 Reqwest 的异步 API 调用和错误处理，实现 F1.0 基础调用。

Rusqlite 仅用于基础的用户设置存储，不涉及复杂数据结构。

前端 (React)：

搭建 React + TailwindCSS UI 基础，实现阅读视图。

完成 F1.0 的选中文字 -> 命令调用 -> 侧边栏纯文本展示的完整交互。

第二阶段：本章互动
核心焦点： 实现基于本章上下文的互动讨论。

后端 (Rust)：

优化 Context Handler，确保稳定传输当前章节文本作为 LLM 的主要上下文。

优化 Agent Core，确保 Agent 严格遵循**“仅基于当前章节回答”**的指令。

前端 (React)：

完成 F3.0 (互动讨论) 的对话模式 UI（聊天气泡）。

实现侧边栏的 F1.0 和 F3.0 模式切换逻辑。